{% extends 'base.html' %}
{% block title %}–ü–µ—Ä–µ–º–µ—â–µ–Ω–∏—è{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1>–ü–µ—Ä–µ–º–µ—â–µ–Ω–∏—è</h1>
        <div>
            <a href="{% url 'create_supply' %}" class="btn btn-success">üì• –°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç–∞–≤–∫—É</a>
            <a href="{% url 'create_shipping' %}" class="btn btn-primary">üì§ –°–æ–∑–¥–∞—Ç—å –æ—Ç–≥—Ä—É–∑–∫—É</a>
        </div>
    </div>

    <a href="{% url 'index' %}" class="btn btn-secondary mb-3">‚Üê –ù–∞–∑–∞–¥ –Ω–∞ –≥–ª–∞–≤–Ω—É—é</a>

    <!-- –ü–æ–∏—Å–∫ -->
    <div class="card mb-4">
        <div class="card-body">
            <form method="get">
                <div class="row g-3 align-items-center">
                    <div class="col-auto">
                        <label for="search" class="col-form-label">–ü–æ–∏—Å–∫:</label>
                    </div>
                    <div class="col-md-6">
                        <input type="text"
                               id="search"
                               name="search"
                               class="form-control"
                               placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥, –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞ –∏–ª–∏ —Å–∫–ª–∞–¥..."
                               value="{{ search_query }}">
                    </div>
                    <div class="col-auto">
                        <button type="submit" class="btn btn-outline-primary">–ù–∞–π—Ç–∏</button>
                        {% if search_query %}
                        <a href="{% url 'movements_list' %}" class="btn btn-outline-secondary">–°–±—Ä–æ—Å–∏—Ç—å</a>
                        {% endif %}
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ -->
    {% if search_query %}
    <div class="alert alert-info mb-3">
        –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –¥–ª—è: "<strong>{{ search_query }}</strong>"
        {% if not supplies and not shippings %}
        - –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
        {% endif %}
    </div>
    {% endif %}

    <!-- –û–±—â–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–π -->
    <table class="table table-striped table-hover">
        <thead class="table-light">
        <tr>
            <th>–ö–æ–¥</th>
            <th>–¢–∏–ø</th>
            <th>–ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç</th>
            <th>–°–∫–ª–∞–¥</th>
            <th>–î–∞—Ç–∞</th>
            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
        </tr>
        </thead>
        <tbody>
        <!-- –ü–æ—Å—Ç–∞–≤–∫–∏ -->
        {% for supply in supplies %}
        <tr>
            <td>{{ supply.code }}</td>
            <td>
                <span class="badge bg-success">üì• –ü–æ—Å—Ç–∞–≤–∫–∞</span>
            </td>
            <td>{{ supply.supplier.name }}</td>
            <td>{{ supply.warehouse.name }}</td>
            <td>{{ supply.created_at|date:"d.m.Y H:i" }}</td>
            <td>
                <a href="{% url 'supply_detail' supply.id %}" class="btn btn-sm btn-outline-primary">
                    –ü—Ä–æ—Å–º–æ—Ç—Ä
                </a>
            </td>
        </tr>
        {% endfor %}

        <!-- –û—Ç–≥—Ä—É–∑–∫–∏ -->
        {% for shipping in shippings %}
        <tr>
            <td>{{ shipping.code }}</td>
            <td>
                <span class="badge bg-primary">üì§ –û—Ç–≥—Ä—É–∑–∫–∞</span>
            </td>
            <td>{{ shipping.client.name }}</td>
            <td>{{ shipping.warehouse.name }}</td>
            <td>{{ shipping.created_at|date:"d.m.Y H:i" }}</td>
            <td>
                <a href="{% url 'shipping_detail' shipping.id %}" class="btn btn-sm btn-outline-primary">
                    –ü—Ä–æ—Å–º–æ—Ç—Ä
                </a>
            </td>
        </tr>
        {% endfor %}

        <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –ø—É—Å—Ç–æ–π –±–∞–∑–µ -->
        {% if not supplies and not shippings %}
        <tr>
            <td colspan="6" class="text-center text-muted">
                {% if search_query %}
                    –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
                {% else %}
                    –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç
                {% endif %}
            </td>
        </tr>
        {% endif %}
        </tbody>
    </table>
</div>
{% endblock %}